Creo que funciona, ¿Cómo lo ves?, ¿Qué hace falta?,  ¿la fecha de pago es igual a la fecha de entrega del pedido?, ¿Se puede hacer el análisis profundo que te propuse ahora mismo?

me ataca una duda, los cálculos que debemos hacer para un análisis 360º son los siguientes: tasa de cancelación de las fechas seleccionadas, se mira cuantos pedidos hubo en shopify y cuantos hay en dropi los que falten son cancelaciones, y los que aparecen directamente cancelados en dropi y se suman, devoluciones (se ven en dropi fácilmente), entregados y en los que están en otro estados guía generada, en ruta, etc. todos esos los vamos a llamar pendientes para no enredarnos, ¿Qué pasa? nosotros de momento podemos sacar los ingresos y egresos de determinada fecha, ejemplo sacamos los egresos y los ingresos del 1 de noviembre al 15 de noviembre, pero sabemos que en esas fechas pueden haber ingresos de pedidos de octubre, lo que hacemos es no tener en cuenta esos ingresos y egresos de pedidos que no sean entre el 1 y el 15 de noviembre, perfecto!, pero entonces vendimos 100 pedidos entre el 1 al 15 de noviembre y lo primero que debemos tener claro es identificar cuales fueron esos pedidos para poder descartar los que no sean de esa fecha y segundo conociendo bien esos pedidos debemos contrastar cuales han sido entregados y cuales nos ha pagado dropi, con eso podemos identificar, te estas ganando 500.000 cop pero ojo que dropi solo te ingresado 450.000 falta por ingresarte el pago de estos pedidos ids (145xx, 124xx, 324xx, etc), supongamos que entregaos 60 pedidos, 10 ya han sido devolución, hay que saber identificar cuales y también contrastar y decir, mira de los 500.000 ganados aparte que dropi no te ha ingresado 50.000 también debes tener en cuenta que 10 son devoluciones y te va a cobrar esos fletes, cada flete cuesta (el problema es que en Colombia cada flete es diferente debe ir a morarlos todos), la suma es 140.000 que se te van a descontar, así que tu ganancia se reduce a 360.000, ¿Qué pasa con los 30 pedidos restantes?, están en pendiente pero acá hay algo más complejo ¿Cómo calculo si se entregan 10 y 20 son devoluciones cuanto me voy a ganar? ¿por que es complejo? por que todos los productos no necesariamente son iguales, pueden ir con diferentes transportadoras, así que todos los fletes cuestan diferente, si son productos diferentes y si vende por dos y tres unidades las ganancias son diferentes también, así que el debe saber muy bien que productos son, cuanto deja de ganancia cada uno, y cuanto es el flete de cada uno para poder hacer estimaciones precisas si se entregan estos (x cantidad) y se devuelven (x cantidad) cuanto es mi ganancia o perdida, ¿lo comprendes?, así que debemos extraer también la info de los pedidos y eso creo que no lo tenemos de dropi .

lucidbot.py
analytics.py